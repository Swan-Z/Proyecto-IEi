<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfaz de carga de datos</title>
    <style>
        /* Estilos opcionales para mejorar la apariencia */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        label {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        input[type="checkbox"] {
            margin-right: 5px;
        }

        button {
            margin-top: 10px;
        }

        #resultados {
            margin-top: 20px;
        }

        #cuadroTexto {
            width: 70%;
            height: 200px;
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            overflow: auto;
        }
    </style>
</head>
<body>

<h1>Carga de almacen de datos</h1>

<label for="fuente">Seleccionar fuente:</label>

<!-- Checkboxes para las opciones -->
<label for="selectAll">
    <input type="checkbox" id="selectAll" />
    Seleccionar todas
</label>

<label for="murcia">
    <input type="checkbox" id="murcia" />
    Murcia
</label>

<label for="comunidadValenciana">
    <input type="checkbox" id="comunidadValenciana" />
    Comunidad Valenciana
</label>

<label for="cataluna">
    <input type="checkbox" id="cataluna" />
    Cataluña
</label>

<!-- Botones de cancelar y cargar -->
<button onclick="cancelar()">Cancelar</button>
<button onclick="cargarDatosDesdeBackend()">Cargar</button>

<!-- Resultados de la carga -->
<h2>Resultados de la carga:</h2>
<div id="resultados"></div>

<!-- Cuadro de texto no editable -->
<div id="cuadroTexto" contenteditable="false"></div>

<script>
    // Manejar la funcionalidad de "Seleccionar todas"
    document.getElementById('selectAll').addEventListener('change', function () {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            checkbox.checked = this.checked;
        });
    });

    async function cargarDatosDesdeBackend() {
        try {
            // Realizar una solicitud al backend para obtener los datos
            const response = await fetch('http://localhost:8000/mensaje', { method: 'GET' });
            const mensaje = await response.text(); // Suponiendo que el mensaje se devuelve como texto

            // Cambiar el texto del cuadro no editable
            document.getElementById('cuadroTexto').textContent = mensaje;

            // Lógica para cargar datos
            const resultados = ["Dato 1", "Dato 2", "Dato 3"];

            // Limpiar el contenedor antes de agregar los nuevos datos
            document.getElementById('resultados').innerHTML = '';

            // Mostrar los resultados en el contenedor
            resultados.forEach(resultado => {
                const labelResultado = document.createElement('label');
                labelResultado.textContent = resultado;
                document.getElementById('resultados').appendChild(labelResultado);
            });
        } catch (error) {
            console.error('Error al cargar datos desde el backend:', error);
        }
    }

    async function enviarDatosAlBackend() {
        try {
            // Obtener los valores de los checkboxes
            const selectAll = document.getElementById('selectAll').checked;
            const murcia = document.getElementById('murcia').checked;
            const comunidadValenciana = document.getElementById('comunidadValenciana').checked;
            const cataluna = document.getElementById('cataluna').checked;

            // Crear un objeto con los valores de los checkboxes
            const datos = {
                selectAll: selectAll,
                murcia: murcia,
                comunidadValenciana: comunidadValenciana,
                cataluna: cataluna
            };

            // Realizar una solicitud al backend enviando los datos
            const response = await fetch(`http://localhost:8000/enviarDatos/${selectALL}/${murcia}/${comunidadValenciana}/${catalunya}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(datos)
            });

            // Realizar acciones adicionales según la respuesta del backend si es necesario
            // ...

            // Puedes agregar lógica para manejar la respuesta del backend aquí
        } catch (error) {
            console.error('Error al enviar datos al backend:', error);
        }
    }
    
    async function metodo() {
        try {
            // Simular la respuesta del backend en formato JSON
            const response = await fetch('http://localhost:8000/mensaje', { method: 'GET' });
            const jsonData = await response.json(); // Suponiendo que el backend devuelve JSON

            // Verificar el tipo de datos recibidos
            if (Array.isArray(jsonData)) {
                // Si es una matriz, mostrar en el cuadro de texto
                document.getElementById('cuadroTexto').textContent = JSON.stringify(jsonData);

                // Lógica para cargar datos
                const resultados = jsonData.flat(); // Aplanar la matriz

                // Limpiar el contenedor antes de agregar los nuevos datos
                document.getElementById('resultados').innerHTML = '';

                // Mostrar los resultados en el contenedor
                resultados.forEach(resultado => {
                    const labelResultado = document.createElement('label');
                    labelResultado.textContent = resultado;
                    document.getElementById('resultados').appendChild(labelResultado);
                });
            } else if (typeof jsonData === 'string') {
                // Si es una cadena, mostrar en el cuadro de texto
                document.getElementById('cuadroTexto').textContent = jsonData;
            } else {
                console.error('Tipo de datos no manejado:', jsonData);
            }
        } catch (error) {
            console.error('Error al cargar datos desde el backend:', error);
        }
    }
    // Función para cancelar la operación
    function cancelar() {
        // Lógica para cancelar la operación
    }
</script>

</body>
</html>
